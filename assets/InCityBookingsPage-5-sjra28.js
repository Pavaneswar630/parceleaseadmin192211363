import{c as N,j as e,r as d,d as B,e as L}from"./index-BHdtNLGV.js";import{a as A}from"./axios-B2YOV0tR.js";import{T as I}from"./trash-2-DuYU1DRA.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=N("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=N("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=N("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),$=({status:s})=>{const r=()=>{switch(s){case"confirmed":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${r()} transition-colors duration-200`,children:s.charAt(0).toUpperCase()+s.slice(1)})},q=({bookings:s,currentPage:r,itemsPerPage:i,searchQuery:y,statusFilter:o})=>{const[x,c]=d.useState("date"),[n,m]=d.useState("asc"),[j,f]=d.useState(null),p=t=>{x===t?m(n==="asc"?"desc":"asc"):(c(t),m("asc"))},g=d.useMemo(()=>{let t=[...s];if(y){const l=y.toLowerCase();t=t.filter(a=>a.id.toLowerCase().includes(l)||a.customerName.toLowerCase().includes(l)||a.location.toLowerCase().includes(l))}return o!=="all"&&(t=t.filter(l=>l.status===o)),x&&t.sort((l,a)=>l[x]<a[x]?n==="asc"?-1:1:l[x]>a[x]?n==="asc"?1:-1:0),t},[s,y,o,x,n]),b=d.useMemo(()=>{const t=(r-1)*i;return g.slice(t,t+i)},[g,r,i]),h=({field:t})=>e.jsx(R,{className:`ml-1 h-4 w-4 transition-transform duration-200 ${x===t?n==="asc"?"text-blue-500 transform rotate-0":"text-blue-500 transform rotate-180":"text-gray-400"}`}),w=t=>{f(j===t?null:t)};return e.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg bg-white",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("id"),children:["Booking ID",e.jsx(h,{field:"id"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("customerName"),children:["Customer",e.jsx(h,{field:"customerName"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("location"),children:["Location",e.jsx(h,{field:"location"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("date"),children:["Date",e.jsx(h,{field:"date"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("time"),children:["Time",e.jsx(h,{field:"time"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("price"),children:["Price",e.jsx(h,{field:"price"})]})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:e.jsxs("button",{className:"group inline-flex items-center",onClick:()=>p("status"),children:["Status",e.jsx(h,{field:"status"})]})}),e.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:b.length>0?b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",onMouseLeave:()=>f(null),children:[e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:t.id}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.customerName}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.location}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.date}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.time}),e.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:["$",t.price]}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.jsx($,{status:t.status})}),e.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>w(t.id),children:e.jsx(T,{className:"h-5 w-5"})}),j===t.id&&e.jsx("div",{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:e.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[e.jsxs("button",{className:"flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[e.jsx(V,{className:"mr-3 h-4 w-4"}),"View Details"]}),e.jsxs("button",{className:"flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:[e.jsx(D,{className:"mr-3 h-4 w-4"}),"Edit Booking"]}),e.jsxs("button",{className:"flex w-full items-center px-4 py-2 text-sm text-red-600 hover:bg-gray-100",role:"menuitem",children:[e.jsx(I,{className:"mr-3 h-4 w-4"}),"Cancel Booking"]})]})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-gray-500",children:"No bookings found matching your criteria"})})})]})})},H=({currentPage:s,totalPages:r,onPageChange:i})=>{const y=()=>{const o=[];let c=Math.max(1,s-Math.floor(2.5)),n=c+5-1;n>r&&(n=r,c=Math.max(1,n-5+1)),c>1&&(o.push(e.jsx("button",{onClick:()=>i(1),className:"px-3 py-1 rounded-md text-sm font-medium hover:bg-gray-100 transition-colors",children:"1"},1)),c>2&&o.push(e.jsx("span",{className:"px-2",children:"..."},"ellipsis-start")));for(let m=c;m<=n;m++)o.push(e.jsx("button",{onClick:()=>i(m),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${m===s?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:m},m));return n<r&&(n<r-1&&o.push(e.jsx("span",{className:"px-2",children:"..."},"ellipsis-end\\")),o.push(e.jsx("button",{onClick:()=>i(r),className:"px-3 py-1 rounded-md text-sm font-medium hover:bg-gray-100 transition-colors",children:r},r))),o};return e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200",children:[e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing page ",e.jsx("span",{className:"font-medium",children:s})," of"," ",e.jsx("span",{className:"font-medium",children:r})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>i(Math.max(1,s-1)),disabled:s===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 ${s===1?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(B,{className:"h-5 w-5","aria-hidden":"true"})]}),e.jsx("div",{className:"flex items-center",children:y()}),e.jsxs("button",{onClick:()=>i(Math.min(r,s+1)),disabled:s===r,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 ${s===r?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(L,{className:"h-5 w-5","aria-hidden":"true"})]})]})})]}),e.jsxs("div",{className:"flex sm:hidden justify-between w-full",children:[e.jsx("button",{onClick:()=>i(Math.max(1,s-1)),disabled:s===1,className:`relative inline-flex items-center rounded-md px-4 py-2 text-sm font-medium text-gray-700 bg-white ring-1 ring-gray-300 ${s===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Previous"}),e.jsxs("p",{className:"text-sm text-gray-700 self-center",children:["Page ",s," of ",r]}),e.jsx("button",{onClick:()=>i(Math.min(r,s+1)),disabled:s===r,className:`relative ml-3 inline-flex items-center rounded-md px-4 py-2 text-sm font-medium text-gray-700 bg-white ring-1 ring-gray-300 ${s===r?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"})]})]})},F=()=>{const[s,r]=d.useState([]),[i,y]=d.useState(""),[o,x]=d.useState(1),[c,n]=d.useState("all"),[m,j]=d.useState(!1),f=50;d.useEffect(()=>{(async()=>{try{const l=await A.get("http://localhost:4000/api/incity-bookings");console.log("ðŸ“¦ InCity API response:",l.data);const a=l.data.map(u=>{var v,k,C,S;const M=((v=u.status)==null?void 0:v.toLowerCase().replace(/_/g,"-"))||"pending";return{id:u.parcel_id,customerName:u.sender_name||"N/A",location:u.pickup_location||"N/A",date:((k=u.delivery_time)==null?void 0:k.split(" ")[0])||"N/A",time:((S=(C=u.delivery_time)==null?void 0:C.split(" ")[1])==null?void 0:S.slice(0,5))||"N/A",duration:1,price:Number(u.amount||0),status:M,createdAt:u.created_at||""}});r(a)}catch(l){console.error("âŒ Failed to fetch bookings",l)}})()},[]);const p=d.useMemo(()=>{let t=[...s];const l=i.toLowerCase();return i&&(t=t.filter(a=>a.id.toLowerCase().includes(l)||a.customerName.toLowerCase().includes(l)||a.location.toLowerCase().includes(l))),c!=="all"&&(t=t.filter(a=>a.status===c)),t},[s,i,c]),g=Math.ceil(p.length/f),b=t=>{x(t),window.scrollTo({top:0,behavior:"smooth"})},h=()=>{j(!0),setTimeout(()=>{window.location.reload()},800)},w=()=>{alert("CSV export functionality would be implemented here")};return e.jsxs("div",{className:"min-h-screen bg-white px-6 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"In-City Bookings"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search bookings...",value:i,onChange:t=>y(t.target.value),className:"border px-3 py-1 rounded"}),e.jsxs("select",{value:c,onChange:t=>n(t.target.value),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in-transit",children:"In Transit"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsx("button",{onClick:h,className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:m?"Refreshing...":"Refresh"}),e.jsx("button",{onClick:w,className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:"Export CSV"})]})]}),e.jsx(q,{bookings:p,currentPage:o,itemsPerPage:f,searchQuery:i,statusFilter:c}),g>1&&e.jsx(H,{currentPage:o,totalPages:g,onPageChange:b})]})};export{F as default};
